---
import type { ImageMetadata } from 'astro';
import { Picture } from 'astro:assets';

interface Props {
  image: ImageMetadata;
  altText: string;
  caption?: string;
  variant?: 'rounded' | 'plain';
  layout?: 'default' | 'grid';
}

const {
  image,
  altText,
  caption,
  variant = 'plain',
  layout = 'default',
} = Astro.props;
---

<figure
  class:list={[
    'w-fit overflow-clip mx-auto max-h-[300px] md:max-h-[500px] my-12 object-cover',
    { 'rounded-md shadow-2xl': variant === 'rounded' },
    { 'grid grid-cols-2': layout === 'grid' },
  ]}
>
  <Picture
    src={image}
    quality={100}
    loading="eager"
    formats={['avif', 'webp']}
    class="object-cover w-full h-full"
    alt={altText}
  />
  {
    caption && (
      <figcaption
        class:list={[
          'leading-none flex items-center py-3',
          {
            'px-3 w-full text-center bg-white mx-auto justify-center':
              variant === 'rounded',
          },
        ]}
      >
        {caption}
      </figcaption>
    )
  }
</figure>
